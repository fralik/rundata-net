!function(){"use strict";function t(t){if(!t||0===t.length)return"";const e=[];for(let s=0;s<t.length;s++){const n=t[s],o=[];if(n[0]&&n[0].length>0)e.push(n[0][0].name);else{for(let t=1;t<n.length;t++){const e=n[t];if(!e||0===e.length){o.push("");continue}const s=[];for(let t=0;t<e.length;t++){const n=e[t];n.isCertain?s.push(n.name):s.push(`${n.name} ?`)}o.push(s.join(","))}e.push(o.join(";"))}}return e.join(" & ")}importScripts("https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"),onmessage=function(e){try{const n=e.data.inscriptions,o=e.data.columnMap,r=e.data.rules,a=Object.keys(o),i=a.map((t=>o[t])),c=function(e,s){const n=[];for(let o=0;o<e.length;o++){const r=[],a=e[o];if(a){for(let e=0;e<s.length;e++){const n=s[e];let o=a[n];null==o&&(o=""),"signature_text"===n&&a.hasOwnProperty("signature_text_raw")&&(o=a.signature_text_raw),"crosses"===n&&(o=t(a[n])),Array.isArray(o)&&(o=o.join(";")),r.push(o)}n.push(r)}else console.error(`No data found for inscription at index: ${o}`)}return n}(n,a),u=XLSX.utils.book_new(),l=XLSX.utils.aoa_to_sheet([i,...c]);if(XLSX.utils.book_append_sheet(u,l,"Results"),r&&(s=r,0!==Object.keys(s).length)){const t=function(t){const e=[],s=JSON.stringify(t,null,2);return e.push(["Search Parameters"]),e.push(["Generated on",(new Date).toLocaleString()]),e.push([""]),e.push([s]),XLSX.utils.aoa_to_sheet(e)}(r);XLSX.utils.book_append_sheet(u,t,"Search Parameters")}const h=XLSX.write(u,{type:"array",bookType:"xlsx"});postMessage({buffer:h,success:!0})}catch(t){console.error("Error in export worker:",t),postMessage({error:!0,message:t.message,stack:t.stack})}var s}}();
//# sourceMappingURL=export.worker.min.js.map
